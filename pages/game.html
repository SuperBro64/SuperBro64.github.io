<!DOCTYPE html>

<html>
    <head>
        <style>
            body
            {
                background: repeating-linear-gradient(90deg, midnightblue 0%, royalblue 50%, midnightblue 100%);
            }
            h1 { font-family: monospace; text-decoration: underline; color: white; }
            h2 { font-family: monospace; text-decoration: underline; color: white; }
            h3 { font-family: monospace; text-decoration: underline; color: white; }
            p  { font-family: monospace; font-size: large; color: white; }
            a:link, a:visited
            {
                background-color: crimson; color: white; display: inline-block;
                font-family: monospace; text-decoration: none; text-align: center;
                padding: 15px 25px; border: 3px solid black;
            }
            a:hover, a:active { background-color: firebrick; }

            #actionButton
            {
                background-color: mediumseagreen; color: black; display: inline-block;
                font-family: monospace; font-size: xx-large; text-align: center;
                padding: 20px 20px; border: 3px solid black;
            }
            #actionButton:active { background-color: seagreen; }
            #audioButton
            {
                background-color: slateblue; color: black; display: inline-block;
                font-family: monospace; font-size: xx-large; text-align: center;
                padding: 20px 20px; border: 3px solid black;
            }
            #audioButton:active { background-color: darkslateblue; }
            #pauseButton
            {
                background-color: goldenrod; color: black; display: inline-block;
                font-family: monospace; font-size: xx-large; text-align: center;
                padding: 20px 20px; border: 3px solid black;
            }
            #pauseButton:active { background-color: darkgoldenrod; }
            #controls { background-color: lightgray; border: 5px solid black; }
            
            .prevent-select { -webkit-user-select: none; -ms-user-select: none; user-select: none; }
            .row { display: inline-block; clear: both; }
        </style>

        <link rel = "preload" href = "../sounds/Super_Mario_64_-_Camera_Click.wav" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Mario_64_-_Coin.wav" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Mario_64_-_Enter_Course.wav" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Mario_64_-_Pause.wav" as = "audio">

        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_Bonus.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_Clear.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_Credits.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_Menu.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_Soccer.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_Target.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_Title.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_World_1.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_World_2.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_World_3.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_World_4.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_World_5.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_World_6.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_World_7.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_World_8.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_World_9.mp3" as = "audio">
        <link rel = "preload" href = "../sounds/Super_Monkey_Ball_2_-_World_10.mp3" as = "audio">
    </head>

    <body onload = "startGame()">

        <div id = "controls" class = "row" style = "text-align: center; vertical-align: text-bottom;">
            <div id = "joystick" style = "margin-top: 8px; margin-bottom: 8px;"></div>

            <div id = "buttons" class = "prevent-select" style = "margin-bottom: 8px; margin-left: 8px; margin-right: 8px;">
                <button id = "audioButton" onclick = "changeAudioVolume()"><b>üîä</b></button>
                <button id = "actionButton" onclick = "playerAction()" style = "margin-left: 5px; margin-right: 5px;"><b>üÖ∞Ô∏è</b></button>
                <button id = "pauseButton" onclick = "pauseGame()"><b>‚è∏Ô∏è</b></button>
            </div>
        </div>

        <script>
            // Setup for the start of the game
            function startGame()
            {
                gameArea.start(800, 600, "border: 5px solid black", "lightgray", 0, 0, 0, 20);
                completion = [["Level 1", 0], ["Level 2", 0], ["Level 3", 0], ["Level 4", 0], ["Level 5", 0],
                              ["Level 6", 0], ["Level 7", 0], ["Level 8", 0], ["Level 9", 0], ["Level 10", 0],
                              ["Level A", 0], ["Level B", 0], ["Level C", 0]];
                music = new componentSound("", "BGM"), sfx = new componentSound("", "SFX");

                levelSetup.titleScreen();
            }

            // Variables for all of the various objects within the game area
            var player, treasure = [], warps = [];
            var completion = [[]], hud, music, sfx;

            // Variable for the playable game area
            var gameArea =
            {
                canvas: document.createElement("canvas"),

                start: function(width, height, style, fillColor, x, y, frameNum, updateSpeed)
                {
                    this.canvas.width = width, this.canvas.height = height;
                    this.canvas.style = style, this.fillColor = fillColor;
                    this.x = x, this.y = y;
                    this.frameNum = frameNum, this.updateSpeed = updateSpeed;

                    this.context = this.canvas.getContext("2d");

                    this.context.fillStyle = this.fillColor;
                    this.context.fillRect(this.x, this.y, this.canvas.width, this.canvas.height);

                    document.body.insertBefore(this.canvas, document.body.childNodes[0]);
                    this.interval = setInterval(updateGameArea, this.updateSpeed);
                },

                clear: function()
                {
                    this.context.clearRect(this.x, this.y, this.canvas.width, this.canvas.height);
                    this.context.fillStyle = this.fillColor;
                    this.context.fillRect(this.x, this.y, this.canvas.width, this.canvas.height);
                }
            }

            // Variable containing the object setup for every level in the game
            var levelSetup =
            {
                // Setup for the title screen
                titleScreen: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [];
                    warps = [(new componentWarp(100, 100, 30, 30, "green", 2, "black", "Credits")),
                            (new componentWarp(385, 100, 30, 30, "green", 2, "black", "Hub Level"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "HEROIC TRIACONTAGON'S MYSTIFYING LEVELS", 0);
                    music.sound.src = "../sounds/Super_Monkey_Ball_2_-_Title.mp3"; music.play();
                },

                // Setup for the credits;
                credits: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [];
                    warps = [(new componentWarp(385, 500, 30, 30, "green", 2, "black", "Title Screen"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "Credits", 0);
                    music.sound.src = "../sounds/Super_Monkey_Ball_2_-_Credits.mp3"; music.play();
                },

                // Setup for the hub level
                hubLevel: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [];
                    warps = [(new componentWarp(385, 500, 30, 30, "green", 2, "black", "Title Screen")),
                            (new componentWarp(100, 100, 30, 30, "sienna", 2, "black", "Level 1", "Level 1")),
                            (new componentWarp(160, 100, 30, 30, "sienna", 2, "black", "Level 2", "Level 2")),
                            (new componentWarp(220, 100, 30, 30, "sienna", 2, "black", "Level 3", "Level 3")),
                            (new componentWarp(280, 100, 30, 30, "sienna", 2, "black", "Level 4", "Level 4")),
                            (new componentWarp(340, 100, 30, 30, "sienna", 2, "black", "Level 5", "Level 5")),
                            (new componentWarp(460, 100, 30, 30, "sienna", 2, "black", "Level 6", "Level 6")),
                            (new componentWarp(520, 100, 30, 30, "sienna", 2, "black", "Level 7", "Level 7")),
                            (new componentWarp(580, 100, 30, 30, "sienna", 2, "black", "Level 8", "Level 8")),
                            (new componentWarp(640, 100, 30, 30, "sienna", 2, "black", "Level 9", "Level 9")),
                            (new componentWarp(700, 100, 30, 30, "sienna", 2, "black", "Level 10", "Level 10")),
                            (new componentWarp(700, 200, 30, 30, "sienna", 2, "black", "Level A", "Level A")),
                            (new componentWarp(700, 350, 30, 30, "sienna", 2, "black", "Level B", "Level B")),
                            (new componentWarp(700, 500, 30, 30, "sienna", 2, "black", "Level C", "Level C"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "Hub Level", 0);

                    if (hud.calculateCompletion() == 100) { music.sound.src = "../sounds/Super_Monkey_Ball_2_-_Clear.mp3"; }
                    else { music.sound.src = "../sounds/Super_Monkey_Ball_2_-_Menu.mp3"; } music.play();
                },

                // Setup for level 1
                level1: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [(new componentTreasure(200, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(200, 450, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 450, 10, 0, 2, "gold", 2, "black"))];
                    warps = [(new componentWarp(385, 100, 30, 30, "cyan", 2, "black", "Hub Level", "Goal"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "Level 1", 30);
                    music.sound.src = "../sounds/Super_Monkey_Ball_2_-_World_1.mp3"; music.play();
                },

                // Setup for level 2
                level2: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [(new componentTreasure(200, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(200, 450, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 450, 10, 0, 2, "gold", 2, "black"))];
                    warps = [(new componentWarp(385, 100, 30, 30, "cyan", 2, "black", "Hub Level", "Goal"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "Level 2", 30);
                    music.sound.src = "../sounds/Super_Monkey_Ball_2_-_World_2.mp3"; music.play();
                },

                // Setup for level 3
                level3: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [(new componentTreasure(200, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(200, 450, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 450, 10, 0, 2, "gold", 2, "black"))];
                    warps = [(new componentWarp(385, 100, 30, 30, "cyan", 2, "black", "Hub Level", "Goal"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "Level 3", 30);
                    music.sound.src = "../sounds/Super_Monkey_Ball_2_-_World_3.mp3"; music.play();
                },

                // Setup for level 4
                level4: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [(new componentTreasure(200, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(200, 450, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 450, 10, 0, 2, "gold", 2, "black"))];
                    warps = [(new componentWarp(385, 100, 30, 30, "cyan", 2, "black", "Hub Level", "Goal"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "Level 4", 30);
                    music.sound.src = "../sounds/Super_Monkey_Ball_2_-_World_4.mp3"; music.play();
                },

                // Setup for level 5
                level5: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [(new componentTreasure(200, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(200, 450, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 450, 10, 0, 2, "gold", 2, "black"))];
                    warps = [(new componentWarp(385, 100, 30, 30, "cyan", 2, "black", "Hub Level", "Goal"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "Level 5", 30);
                    music.sound.src = "../sounds/Super_Monkey_Ball_2_-_World_5.mp3"; music.play();
                },

                // Setup for level 6
                level6: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [(new componentTreasure(200, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(200, 450, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 450, 10, 0, 2, "gold", 2, "black"))];
                    warps = [(new componentWarp(385, 100, 30, 30, "cyan", 2, "black", "Hub Level", "Goal"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "Level 6", 30);
                    music.sound.src = "../sounds/Super_Monkey_Ball_2_-_World_6.mp3"; music.play();
                },

                // Setup for level 7
                level7: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [(new componentTreasure(200, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(200, 450, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 450, 10, 0, 2, "gold", 2, "black"))];
                    warps = [(new componentWarp(385, 100, 30, 30, "cyan", 2, "black", "Hub Level", "Goal"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "Level 7", 30);
                    music.sound.src = "../sounds/Super_Monkey_Ball_2_-_World_7.mp3"; music.play();
                },

                // Setup for level 8
                level8: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [(new componentTreasure(200, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(200, 450, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 450, 10, 0, 2, "gold", 2, "black"))];
                    warps = [(new componentWarp(385, 100, 30, 30, "cyan", 2, "black", "Hub Level", "Goal"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "Level 8", 30);
                    music.sound.src = "../sounds/Super_Monkey_Ball_2_-_World_8.mp3"; music.play();
                },

                // Setup for level 9
                level9: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [(new componentTreasure(200, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(200, 450, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 450, 10, 0, 2, "gold", 2, "black"))];
                    warps = [(new componentWarp(385, 100, 30, 30, "cyan", 2, "black", "Hub Level", "Goal"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "Level 9", 30);
                    music.sound.src = "../sounds/Super_Monkey_Ball_2_-_World_9.mp3";  music.play();
                },

                // Setup for level 10
                level10: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [(new componentTreasure(200, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(200, 450, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 450, 10, 0, 2, "gold", 2, "black"))];
                    warps = [(new componentWarp(385, 100, 30, 30, "cyan", 2, "black", "Hub Level", "Goal"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "Level 10", 30);
                    music.sound.src = "../sounds/Super_Monkey_Ball_2_-_World_10.mp3"; music.play();
                },

                // Setup for level A
                levelA: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [(new componentTreasure(200, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(200, 450, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 450, 10, 0, 2, "gold", 2, "black"))];
                    warps = [(new componentWarp(385, 100, 30, 30, "cyan", 2, "black", "Hub Level", "Goal"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "Level A", 30);
                    music.sound.src = "../sounds/Super_Monkey_Ball_2_-_Bonus.mp3"; music.play();
                },

                // Setup for level B
                levelB: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [(new componentTreasure(200, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(200, 450, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 450, 10, 0, 2, "gold", 2, "black"))];
                    warps = [(new componentWarp(385, 100, 30, 30, "cyan", 2, "black", "Hub Level", "Goal"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "Level B", 30);
                    music.sound.src = "../sounds/Super_Monkey_Ball_2_-_Target.mp3"; music.play();
                },

                // Setup for level C
                levelC: function()
                {
                    player = new componentPlayer(400, 300, 20, 0, 2, "red", 2, "black");
                    treasure = [(new componentTreasure(200, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(200, 450, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 150, 10, 0, 2, "gold", 2, "black")),
                                (new componentTreasure(600, 450, 10, 0, 2, "gold", 2, "black"))];
                    warps = [(new componentWarp(385, 100, 30, 30, "cyan", 2, "black", "Hub Level", "Goal"))];

                    hud = new componentHud("25px monospace", "black", 10, 30, "Level C", 30);
                    music.sound.src = "../sounds/Super_Monkey_Ball_2_-_Soccer.mp3"; music.play();
                }
            }

            // Code for the player
            function componentPlayer(x, y, radius, startAngle, endAngle, fillColor, lineWidth, lineColor)
            {
                this.speedX = 0, this.speedY = 0;
                this.x = x, this.y = y, this.radius = radius;
                this.startAngle = startAngle, this.endAngle = endAngle;
                this.fillColor = fillColor, this.lineWidth = lineWidth, this.lineColor = lineColor;
                this.action = false;

                this.update = function()
                {
                    this.context = gameArea.context;

                    this.context.beginPath();
                    this.context.arc(this.x, this.y, this.radius, this.startAngle, this.endAngle * Math.PI);
                    this.context.fillStyle = this.fillColor;
                    this.context.fill();

                    this.context.lineWidth = this.lineWidth;
                    this.context.strokeStyle = this.lineColor;
                    this.context.stroke();

                    this.action = false;
                }

                this.newPosition = function()
                {
                    var joystickAngle = Math.atan2(joystick.getY(), joystick.getX()) * 180 / Math.PI;

                    if (joystickAngle < 0) { joystickAngle += 360; }

                    if (joystick.getX() < 25 && joystick.getX() > -25 && joystick.getY() < 25 && joystick.getY() > -25) { stopMoving(); }
                    else
                    {
                        if ((joystickAngle >= 0 && joystickAngle < 11.25) ||
                            (joystickAngle >= 348.75 && joystickAngle < 360)) { moveRight(); }
                        else if (joystickAngle >= 11.25 && joystickAngle < 33.75) { moveRightDownRight(); }
                        else if (joystickAngle >= 33.75 && joystickAngle < 56.25) { moveDownRight(); }
                        else if (joystickAngle >= 56.25 && joystickAngle < 78.75) { moveDownDownRight(); }
                        else if (joystickAngle >= 78.75 && joystickAngle < 101.25) { moveDown(); }
                        else if (joystickAngle >= 101.25 && joystickAngle < 123.75) { moveDownDownLeft(); }
                        else if (joystickAngle >= 123.75 && joystickAngle < 146.25) { moveDownLeft(); }
                        else if (joystickAngle >= 146.25 && joystickAngle < 168.75) { moveLeftDownLeft(); }
                        else if (joystickAngle >= 168.75 && joystickAngle < 191.25) { moveLeft(); }
                        else if (joystickAngle >= 191.25 && joystickAngle < 213.75) { moveLeftUpLeft(); }
                        else if (joystickAngle >= 213.75 && joystickAngle < 236.25) { moveUpLeft(); }
                        else if (joystickAngle >= 236.25 && joystickAngle < 258.75) { moveUpUpLeft(); }
                        else if (joystickAngle >= 258.75 && joystickAngle < 281.25) { moveUp(); }
                        else if (joystickAngle >= 281.25 && joystickAngle < 303.75) { moveUpUpRight(); }
                        else if (joystickAngle >= 303.75 && joystickAngle < 326.25) { moveUpRight(); }
                        else if (joystickAngle >= 326.25 && joystickAngle < 348.75) { moveRightUpRight(); }

                        if (joystick.getX() < 75 && joystick.getX() > -75) { player.speedX /= 2; }
                        if (joystick.getY() < 75 && joystick.getY() > -75) { player.speedY /= 2; }
                    }

                    if ((this.x + this.speedX) >= 0 && (this.x + this.speedX) <= gameArea.canvas.width) { this.x += this.speedX; }
                    if ((this.y + this.speedY) >= 0 && (this.y + this.speedY) <= gameArea.canvas.height) { this.y += this.speedY; }
                }

                this.collectTreasure = function(treasure)
                {
                    var left = this.x - this.radius, right = this.x + this.radius;
                    var top = this.y - this.radius, bottom = this.y + this.radius;

                    var treasLeft = treasure.x - treasure.radius, treasRight = treasure.x + treasure.radius;
                    var treasTop = treasure.y - treasure.radius, treasBottom = treasure.y + treasure.radius;

                    var collected = true;

                    if ((bottom < treasTop) || (top > treasBottom) || (right < treasLeft) || (left > treasRight)) { collected = false; }

                    return collected;
                }

                this.enterWarp = function(warp)
                {
                    var left = this.x - this.radius, right = this.x + this.radius;
                    var top = this.y - this.radius, bottom = this.y + this.radius;

                    var warpLeft = warp.x, warpRight = warp.x + warp.width;
                    var warpTop = warp.y, warpBottom = warp.y + warp.height;

                    var entered = true;

                    if ((bottom < warpTop) || (top > warpBottom) || (right < warpLeft) || (left > warpRight)) { entered = false; }

                    return entered;
                }
            }

            // Code for the treasure
            function componentTreasure(x, y, radius, startAngle, endAngle, fillColor, lineWidth, lineColor)
            {
                this.x = x, this.y = y, this.radius = radius;
                this.startAngle = startAngle, this.endAngle = endAngle;
                this.fillColor = fillColor, this.lineWidth = lineWidth, this.lineColor = lineColor;
                this.sfx = new componentSound("", "SFX");

                this.update = function()
                {
                    this.context = gameArea.context;

                    this.context.beginPath();
                    this.context.arc(this.x, this.y, this.radius, this.startAngle, this.endAngle * Math.PI);
                    this.context.fillStyle = this.fillColor;
                    this.context.fill();

                    this.context.lineWidth = this.lineWidth;
                    this.context.strokeStyle = this.lineColor;
                    this.context.stroke();
                }

                this.disappear = function()
                {
                    this.radius = 0;
                    this.sfx.sound.src = "../sounds/Super_Mario_64_-_Coin.wav"; this.sfx.play();
                }
            }

            // Code for the warps
            function componentWarp(x, y, width, height, fillColor, lineWidth, lineColor, destination, type)
            {
                this.x = x, this.y = y, this.width = width, this.height = height, this.angle = 0;
                this.fillColor = fillColor, this.lineWidth = lineWidth, this.lineColor = lineColor;
                this.rotationSpeed = 180, this.destination = destination, this.type = type;
                this.sfx = new componentSound("", "SFX");

                for (i = 0; i < completion.length; i += 1)
                {
                    if (completion[i][0] == this.type)
                    {
                        if (completion[i][1] == 0) { this.fillColor = "sienna"; }
                        else if (completion[i][1] == 1) { this.fillColor = "silver"; }
                        else if (completion[i][1] == 2) { this.fillColor = "gold"; }
                        break;
                    }
                }

                this.update = function()
                {
                    this.context = gameArea.context;
                    this.context.save();

                    this.context.translate(this.x, this.y);
                    this.context.rotate(this.angle);

                    this.context.fillStyle = this.fillColor;
                    this.context.fillRect(this.width / -2, this.height / -2, this.width, this.height);

                    this.context.lineWidth = this.lineWidth;
                    this.context.strokeStyle = this.lineColor;
                    this.context.strokeRect(this.width / -2, this.height / -2, this.width, this.height);

                    this.context.restore();
                }

                this.toDestination = function()
                {
                    music.stop();
                    gameArea.frameNum = 0;
                    this.sfx.sound.src = "../sounds/Super_Mario_64_-_Enter_Course.wav"; this.sfx.play();

                    if (this.type == "Goal")
                    {
                        for (i = 0; i < completion.length; i += 1)
                        {
                            if (completion[i][0] == hud.currentLevel)
                            {
                                if (hud.treasureCollected == treasure.length) { completion[i][1] = 2; }
                                else if (completion[i][1] != 2) { completion[i][1] = 1; } break;
                            }
                        }
                    }

                    if (this.destination == "Title Screen") { levelSetup.titleScreen(); }
                    else if (this.destination == "Credits") { levelSetup.credits(); }
                    else if (this.destination == "Hub Level") { levelSetup.hubLevel(); }
                    else if (this.destination == "Level 1") { levelSetup.level1(); }
                    else if (this.destination == "Level 2") { levelSetup.level2(); }
                    else if (this.destination == "Level 3") { levelSetup.level3(); }
                    else if (this.destination == "Level 4") { levelSetup.level4(); }
                    else if (this.destination == "Level 5") { levelSetup.level5(); }
                    else if (this.destination == "Level 6") { levelSetup.level6(); }
                    else if (this.destination == "Level 7") { levelSetup.level7(); }
                    else if (this.destination == "Level 8") { levelSetup.level8(); }
                    else if (this.destination == "Level 9") { levelSetup.level9(); }
                    else if (this.destination == "Level 10") { levelSetup.level10(); }
                    else if (this.destination == "Level A") { levelSetup.levelA(); }
                    else if (this.destination == "Level B") { levelSetup.levelB(); }
                    else if (this.destination == "Level C") { levelSetup.levelC(); }
                }
            }

            // Code for the heads-up display
            function componentHud(font, color, x, y, currentLevel, startingTime)
            {
                this.currentLevel = currentLevel, this.treasureCollected = 0;
                this.startingTime = startingTime, this.timeRemaining = (this.startingTime - (gameArea.frameNum / 50)).toFixed(1);
                this.font = font, this.color = color;
                this.x = x, this.y = y;

                this.update = function()
                {
                    this.context = gameArea.context;
                    
                    if (this.timeRemaining > 0) { this.timeRemaining = (this.startingTime - (gameArea.frameNum / 50)).toFixed(1); }

                    this.context.font = this.font;
                    this.context.fillStyle = this.color;
                    this.context.fillText(this.text, this.x, this.y);
                }

                this.calculateCompletion = function()
                {
                    percentage = 0.00;
                    for (i = 0; i < completion.length; i += 1) { percentage += completion[i][1]; }
                    return Math.min(((percentage / (completion.length * 2)) * 100), 100).toFixed(2);
                }
            }

            // Code for playing the game's background music and sound effects
            function componentSound(source, type)
            {
                this.sound = document.createElement("audio");
                this.sound.src = source, this.sound.volume = 0.3;

                if (type == "BGM") { this.sound.loop = true; }
                else if (type == "SFX") { this.sound.loop = false; }

                this.sound.setAttribute("preload", "auto");
                this.sound.setAttribute("controls", "none");
                this.sound.style.display = "none";
                document.body.appendChild(this.sound);

                this.play = function() { this.sound.play(); }
                this.stop = function() { this.sound.pause(); }
            }

            // Code for updating the game area and everything in it on every frame
            function updateGameArea()
            {
                gameArea.clear();
                gameArea.frameNum += 1;

                for (i = 0; i < treasure.length; i += 1)
                {
                    if (player.collectTreasure(treasure[i]) && treasure[i].radius != 0)
                    {
                        treasure[i].disappear();
                        hud.treasureCollected += 1;
                    }
                    treasure[i].update();
                }

                for (i = 0; i < warps.length; i += 1)
                {
                    if (player.enterWarp(warps[i]))
                    {
                        warps[i].rotationSpeed = 45;

                        if (player.action) { warps[i].toDestination(); }
                    }
                    else { warps[i].rotationSpeed = 180; }

                    warps[i].angle += (1 * Math.PI / warps[i].rotationSpeed);
                    warps[i].update();
                }

                hud.text = hud.currentLevel;
                if (hud.currentLevel == "Hub Level") { hud.text += " | Total Completion: " + hud.calculateCompletion() + "%"; }
                if (treasure.length > 0) { hud.text += " | Treasure: " + hud.treasureCollected + "/" + treasure.length; }
                if (hud.startingTime > 0) { hud.text += " | Time: " + hud.timeRemaining; }
                hud.update();

                player.newPosition();
                player.update();
            }

            // Code for tracking if something is happening every n frames
            function everyInterval(n)
            {
                if ((gameArea.frameNum / n) % 1 == 0) { return true; }
                return false;
            }

            // Code for the player's 16-directional movement as well as stopping
            function moveRight()          { player.speedX = 4, player.speedY = 0; }
            function moveRightDownRight() { player.speedX = 3.464, player.speedY = -2; }
            function moveDownRight()      { player.speedX = 2.828, player.speedY = -2.828; }
            function moveDownDownRight()  { player.speedX = 2, player.speedY = -3.464; }
            function moveDown()           { player.speedX = 0, player.speedY = -4; }
            function moveDownDownLeft()   { player.speedX = -2, player.speedY = -3.464; }
            function moveDownLeft()       { player.speedX = -2.828, player.speedY = -2.828; }
            function moveLeftDownLeft()   { player.speedX = -3.464, player.speedY = -2; }
            function moveLeft()           { player.speedX = -4, player.speedY = 0; }
            function moveLeftUpLeft()     { player.speedX = -3.464, player.speedY = 2; }
            function moveUpLeft()         { player.speedX = -2.828, player.speedY = 2.828; }
            function moveUpUpLeft()       { player.speedX = -2, player.speedY = 3.464; }
            function moveUp()             { player.speedX = 0, player.speedY = 4; }
            function moveUpUpRight()      { player.speedX = 2, player.speedY = 3.464; }
            function moveUpRight()        { player.speedX = 2.828, player.speedY = 2.828; }
            function moveRightUpRight()   { player.speedX = 3.464, player.speedY = 2; }
            function stopMoving()         { player.speedX = 0, player.speedY = 0; }

            // Code for the player's actions
            function playerAction() { if (gameArea.interval) { player.action = true; } }

            // Code for pausing the game
            function pauseGame()
            {
                const pauseButton = document.querySelector('#pauseButton');

                if (gameArea.interval)
                {
                    pauseButton.innerHTML = "‚ñ∂Ô∏è";
                    sfx.sound.src = "../sounds/Super_Mario_64_-_Pause.wav"; sfx.play();
                    clearInterval(gameArea.interval), gameArea.interval = null;
                }
                else if (!gameArea.interval)
                {
                    pauseButton.innerHTML = "‚è∏Ô∏è";
                    sfx.sound.src = "../sounds/Super_Mario_64_-_Pause.wav"; sfx.play();
                    gameArea.interval = setInterval(updateGameArea, gameArea.updateSpeed);
                }
            }

            // Code for changing the audio volume level of the background music and sound effects
            function changeAudioVolume()
            {
                const audioButton = document.querySelector('#audioButton');

                if (music.sound.volume == 0.3)
                {
                    audioButton.innerHTML = "üîâ";
                    document.querySelectorAll("audio").forEach((element) => element.volume = 0.2);
                }
                else if (music.sound.volume == 0.2)
                {
                    audioButton.innerHTML = "üîà";
                    document.querySelectorAll("audio").forEach((element) => element.volume = 0.1);
                }
                else if (music.sound.volume == 0.1)
                {
                    audioButton.innerHTML = "üîá";
                    document.querySelectorAll("audio").forEach((element) => element.volume = 0.0);
                }
                else if (music.sound.volume == 0.0)
                {
                    audioButton.innerHTML = "üîä";
                    document.querySelectorAll("audio").forEach((element) => element.volume = 0.3);
                }
            }

            // IDEAS TO IMPLEMENT
            // Walls + Bottomless Pits
            // Door Switches + Door Blocks
            // Toggle Switches + Toggle Blocks
            // Shrinkers + Growers
            // Big Door Switches + Big Toggle Switches
            // Push Blocks

            // Code for the joystick, originally by Bobboteck (Roberto D'Amico) on GitHub
            let StickStatus = { xPosition: 0, yPosition: 0, x: 0, y: 0, cardinalDirection: "C" };
            
            var JoyStick = (function (container, parameters, callback)
            {
                parameters = parameters || {};
                var title = (typeof parameters.title === "undefined" ? "joystick" : parameters.title),
                    width = (typeof parameters.width === "undefined" ? 0 : parameters.width),
                    height = (typeof parameters.height === "undefined" ? 0 : parameters.height),
                    internalFillColor = (typeof parameters.internalFillColor === "undefined" ? "darkgray" : parameters.internalFillColor),
                    internalLineWidth = (typeof parameters.internalLineWidth === "undefined" ? 3 : parameters.internalLineWidth),
                    internalStrokeColor = (typeof parameters.internalStrokeColor === "undefined" ? "dimgray" : parameters.internalStrokeColor),
                    externalLineWidth = (typeof parameters.externalLineWidth === "undefined" ? 3 : parameters.externalLineWidth),
                    externalStrokeColor = (typeof parameters.externalStrokeColor === "undefined" ? "dimgray" : parameters.externalStokeColor),
                    autoReturnToCenter = (typeof parameters.autoReturnToCenter === "undefined" ? true : parameters.autoReturnToCenter);
                
                callback = callback || function(StickStatus) {};

                var objContainer = document.getElementById(container);
                objContainer.style.touchAction = "none";

                var canvas = document.createElement("canvas");
                canvas.id = title;
                
                if (width === 0) { width = objContainer.clientWidth; }
                if (height === 0) { height = objContainer.clientHeight; }
                canvas.width = width, canvas.height = height;
                
                objContainer.appendChild(canvas);
                var context = canvas.getContext("2d");

                var pressed = 0;
                var circumference = 2 * Math.PI;
                var internalRadius = (canvas.width - ((canvas.width / 2) + 10)) / 2;
                var maxMoveStick = internalRadius + 5;
                var externalRadius = internalRadius + 30;
                var centerX = canvas.width / 2;
                var centerY = canvas.height / 2;
                var directionHorizontalLimitPos = canvas.width / 10;
                var directionHorizontalLimitNeg = directionHorizontalLimitPos * -1;
                var directionVerticalLimitPos = canvas.height / 10;
                var directionVerticalLimitNeg = directionVerticalLimitPos * -1;

                var movedX = centerX, movedY = centerY;

                if ("ontouchstart" in document.documentElement)
                {
                    canvas.addEventListener("touchstart", onTouchStart, false);
                    document.addEventListener("touchmove", onTouchMove, false);
                    document.addEventListener("touchend", onTouchEnd, false);
                }
                else
                {
                    canvas.addEventListener("mousedown", onMouseDown, false);
                    document.addEventListener("mousemove", onMouseMove, false);
                    document.addEventListener("mouseup", onMouseUp, false);
                }

                drawExternal(); drawInternal();

                function drawExternal()
                {
                    context.beginPath();
                    context.arc(centerX, centerY, externalRadius, 0, circumference, false);
                    context.lineWidth = externalLineWidth;
                    context.strokeStyle = externalStrokeColor;
                    context.stroke();
                }

                function drawInternal()
                {
                    context.beginPath();
                    if (movedX < internalRadius) { movedX = maxMoveStick; }
                    if ((movedX + internalRadius) > canvas.width) { movedX = canvas.width - maxMoveStick; }
                    if (movedY < internalRadius) { movedY = maxMoveStick; }
                    if ((movedY + internalRadius) > canvas.height) { movedY = canvas.height - maxMoveStick; }
                    context.arc(movedX, movedY, internalRadius, 0, circumference, false);

                    var grd = context.createRadialGradient(centerX, centerY, 5, centerX, centerY, 200);
                    grd.addColorStop(0, internalFillColor);
                    grd.addColorStop(1, internalStrokeColor);
                    context.fillStyle = grd;
                    context.fill();
                    context.lineWidth = internalLineWidth;
                    context.strokeStyle = internalStrokeColor;
                    context.stroke();
                }

                let touchId = null;
                function onTouchStart(event) { pressed = 1; touchId = event.targetTouches[0].identifier; }

                function onTouchMove(event)
                {
                    if (pressed === 1 && event.targetTouches[0].target === canvas)
                    {
                        movedX = event.targetTouches[0].pageX, movedY = event.targetTouches[0].pageY;

                        if (canvas.offsetParent.tagName.toUpperCase() === "BODY")
                        {
                            movedX -= canvas.offsetLeft, movedY -= canvas.offsetTop;
                        }
                        else
                        {
                            movedX -= canvas.offsetParent.offsetLeft, movedY -= canvas.offsetParent.offsetTop;
                        }

                        context.clearRect(0, 0, canvas.width, canvas.height);
                        drawExternal(); drawInternal();

                        StickStatus.xPosition = movedX, StickStatus.yPosition = momveY;
                        StickStatus.x = (100 * ((movedX - centerX) / maxMoveStick)).toFixed();
                        StickStatus.y = ((100 * ((movedY - centerY) / maxMoveStick)) * -1).toFixed();
                        StickStatus.cardinalDirection = getCardinalDirection();
                        callback(StickStatus);
                    }
                }

                function onTouchEnd(event)
                {
                    if (event.changedTouches[0].identifier !== touchId) { return; }

                    pressed = 0;

                    if (autoReturnToCenter) { movedX = centerX, movedY = centerY; }

                    context.clearRect(0, 0, canvas.width, canvas.height);
                    drawExternal(); drawInternal();

                    StickStatus.xPosition = movedX, StickStatus.yPosition = movedY;
                    StickStatus.x = (100 * ((movedX - centerX) / maxMoveStick)).toFixed();
                    StickStatus.y = ((100 * ((movedY - centerY) / maxMoveStick)) * -1).toFixed();
                    StickStatus.cardinalDirection = getCardinalDirection();
                    callback(StickStatus);
                }

                function onMouseDown(event) { pressed = 1; }

                function onMouseMove(event)
                {
                    if (pressed === 1)
                    {
                        movedX = event.pageX, movedY = event.pageY;

                        if (canvas.offsetParent.tagName.toUpperCase() === "BODY")
                        {
                            movedX -= canvas.offsetLeft, movedY -= canvas.offsetTop;
                        }
                        else
                        {
                            movedX -= canvas.offsetParent.offsetLeft, movedY -= canvas.offsetParent.offsetTop;
                        }

                        context.clearRect(0, 0, canvas.width, canvas.height);
                        drawExternal(); drawInternal();

                        StickStatus.xPosition = movedX, StickStatus.yPosition = movedY;
                        StickStatus.x = (100 * ((movedX - centerX) / maxMoveStick)).toFixed();
                        StickStatus.y = ((100 * ((movedY - centerY) / maxMoveStick)) * -1).toFixed();
                        StickStatus.cardinalDirection = getCardinalDirection();
                        callback(StickStatus);
                    }
                }

                function onMouseUp(event)
                {
                    pressed = 0;

                    if (autoReturnToCenter) { movedX = centerX, movedY = centerY; }

                    context.clearRect(0, 0, canvas.width, canvas.height);
                    drawExternal(); drawInternal();

                    StickStatus.xPosition = movedX, StickStatus.yPosition = movedY;
                    StickStatus.x = (100 * ((movedX - centerX) / maxMoveStick)).toFixed();
                    StickStatus.y = ((100 * ((movedY - centerY) / maxMoveStick)) * -1).toFixed();
                    StickStatus.cardinalDirection = getCardinalDirection();
                    callback(StickStatus);
                }

                function getCardinalDirection()
                {
                    let result = "";
                    let horizontal = movedX - centerX;
                    let vertical = movedY - centerY;

                    if (vertical >= directionVerticalLimitNeg && vertical <= directionVerticalLimitPos) { result = "C"; }
                    if (vertical < directionVerticalLimitNeg) { result = "N"; }
                    if (vertical > directionVerticalLimitPos) { result = "S"; }

                    if (horizontal < directionHorizontalLimitNeg)
                    {
                        if (result === "C") { result = "W"; }
                        else { result += "W"; }
                    }
                    if (horizontal > directionHorizontalLimitPos)
                    {
                        if (result === "C") { result = "E"; }
                        else { result += "E"; }
                    }

                    return result;
                }

                this.getWidth = function () { return canvas.width; };
                this.getHeight = function () { return canvas.height; };
                this.getPosX = function () { return movedX; };
                this.getPosY = function () { return movedY; };
                this.getX = function () { return (100 * ((movedX - centerX) / maxMoveStick)).toFixed(); };
                this.getY = function () { return ((100 * ((movedY - centerY) / maxMoveStick)) * -1).toFixed(); };
                this.getDir = function () { return getCardinalDirection(); };
            });

            var joystickInputPosX, joystickInputPosY, joystickDirection, joystickX, joystickY;
            
            var joystick = new JoyStick("joystick", { "title": "joystick", "width": 250, "height": 250 }, function(stickData)
            {
                joystickInputPosX = stickData.xPosition;
                joystickInputPosY = stickData.yPosition;
                joystickDirection = stickData.cardinalDirection;
                joystickX = stickData.x;
                joystickY = stickData.y;
            });
        </script>

        <br>
        
        <h1>
            Heroic Triacontagon's Mystifying Levels (WIP)
        </h1>

        <h2>
            Description
        </h2>

        <p>
            Take control of your triacontagon (that's a polygon with 30 sides!) and make your way to the end of
            each level before time runs out! Collect all of the treasure in a level to increase your completion
            percentage! Can you finish every level and reach 100% completion? Good luck!
        </p>

        <h2>
            Controls
        </h2>

        <p>
            - üîò Joystick: Hold-click on the central circle and drag it away from the center to move in that direction. Drag the
            central circle a little away to move slowly and a lot away to move quickly. Drag the central circle back to the
            center or release the click to stop moving.
            <br>
            - üÖ∞Ô∏è Button: Click to perform situation-specific actions when positioned on top of certain objects, such as warp
            zones or switch tiles.
            <br>
            - ‚è∏Ô∏è Button: Click to toggle between pausing and resuming all gameplay functions.
            <br>
            - üîä Button: Click to toggle between different volume levels of or muting all background music and sound effects.
        </p>
        
        <h2>
            Credits
        </h2>

        <p>
            - Game Creator: SuperBro64 (Brandon Jackson)
            <br><br>
            - Background Music: Super Monkey Ball 2
            <a href = "https://downloads.khinsider.com/game-soundtracks/album/super-monkey-ball-2">Source</a>
            <br><br>
            - Sound Effects: Super Mario 64
            <a href = "https://themushroomkingdom.net/media/sm64/wav">Source</a>
            <br><br>
            - Joystick Code: Bobboteck (Roberto D'Amico)
            <a href = "https://github.com/bobboteck/JoyStick">Source</a>
            <br><br>
            <a href = "https://superbro64.github.io/">Back to Homepage</a>
        </p>

    </body>
</html>
